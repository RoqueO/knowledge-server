# DNS Configuration at Hostinger

This document details the DNS records that need to be configured at Hostinger for your self-hosted email server. The domain is `obusan.me` and the mail server will be accessible at `mail.obusan.me`.

## Overview

DNS configuration is done in two phases:
1. **Initial Setup**: Basic A and MX records (done before Mail-in-a-Box installation)
2. **After Installation**: SPF, DKIM, and DMARC records (values provided by Mail-in-a-Box)

## Prerequisites

- Access to Hostinger DNS management panel
- Your static public IP address
- Mail-in-a-Box installed and configured (for SPF/DKIM/DMARC values)

## Initial DNS Records (Before Mail-in-a-Box Setup)

These records should be created first to allow Mail-in-a-Box to obtain SSL certificates and function properly.

### 1. A Record for Mail Server

**Purpose**: Points the mail hostname to your public IP address.

- **Type**: A
- **Name**: `mail` (or `mail.obusan.me` depending on Hostinger interface)
- **Value**: Your static public IP address (e.g., `203.0.113.1`)
- **TTL**: 3600 (or default)

**Note**: Replace `203.0.113.1` with your actual static public IP address.

### 2. MX Record

**Purpose**: Tells other mail servers where to deliver email for your domain.

- **Type**: MX
- **Name**: `@` (or `obusan.me` depending on Hostinger interface)
- **Priority**: 10
- **Value**: `mail.obusan.me`
- **TTL**: 3600 (or default)

## DNS Records After Mail-in-a-Box Installation

After installing Mail-in-a-Box, log into the admin panel at `https://mail.obusan.me/admin` and navigate to the DNS section. Mail-in-a-Box will provide you with the exact values for the following records.

### 3. SPF Record (TXT)

**Purpose**: Specifies which servers are authorized to send email for your domain.

**How to get the value:**
1. Log into Mail-in-a-Box admin panel
2. Go to the DNS section
3. Copy the SPF TXT record value

**Example format:**
- **Type**: TXT
- **Name**: `@` (or `obusan.me`)
- **Value**: `v=spf1 mx a:mail.obusan.me ~all`
- **TTL**: 3600

**Note**: The exact value will be provided by Mail-in-a-Box.

### 4. DKIM Record (TXT)

**Purpose**: Provides cryptographic authentication for your emails.

**How to get the value:**
1. Log into Mail-in-a-Box admin panel
2. Go to the DNS section
3. Copy the DKIM TXT record value (it will be a long string)

**Example format:**
- **Type**: TXT
- **Name**: `mail._domainkey` (or `mail._domainkey.obusan.me`)
- **Value**: `v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC...` (long string)
- **TTL**: 3600

**Note**: The exact value will be generated by Mail-in-a-Box and will be unique to your installation.

### 5. DMARC Record (TXT)

**Purpose**: Defines policy for how receiving servers should handle emails that fail SPF/DKIM checks.

**How to get the value:**
1. Log into Mail-in-a-Box admin panel
2. Go to the DNS section
3. Copy the DMARC TXT record value

**Example format:**
- **Type**: TXT
- **Name**: `_dmarc` (or `_dmarc.obusan.me`)
- **Value**: `v=DMARC1; p=quarantine; rua=mailto:admin@obusan.me`
- **TTL**: 3600

**Note**: The exact value will be provided by Mail-in-a-Box. You can adjust the policy (`p=`) to `none`, `quarantine`, or `reject` based on your preference.

## DNS Propagation

After adding or modifying DNS records:
- Changes typically propagate within a few minutes to a few hours
- You can check propagation using tools like:
  - [whatsmydns.net](https://www.whatsmydns.net/)
  - [dnschecker.org](https://dnschecker.org/)
- Mail-in-a-Box will verify DNS records in the admin panel

## Verifying DNS Records

### Using Command Line

```bash
# Check A record
dig mail.obusan.me A

# Check MX record
dig obusan.me MX

# Check SPF record
dig obusan.me TXT | grep spf

# Check DKIM record
dig mail._domainkey.obusan.me TXT

# Check DMARC record
dig _dmarc.obusan.me TXT
```

### Using Online Tools

- [MXToolbox](https://mxtoolbox.com/) - Comprehensive DNS checking
- [Mail-Tester](https://www.mail-tester.com/) - Email deliverability testing
- [DKIM Validator](https://dkimvalidator.com/) - DKIM record verification

## Important Notes

- **Reverse DNS (PTR)**: Not required. While helpful, SPF/DKIM/DMARC are more important and don't require ISP cooperation.
- **TTL Values**: Lower TTL (e.g., 300) allows faster changes but increases DNS queries. Higher TTL (e.g., 3600) is fine for stable setups.
- **Multiple Records**: Some DNS providers require you to enter the full domain name in the "Name" field, while others use `@` for the root domain. Check Hostinger's interface for the correct format.

## Troubleshooting

### DNS Records Not Showing Up

1. Wait 15-30 minutes for propagation
2. Clear your DNS cache: `ipconfig /flushdns` (Windows) or `sudo systemd-resolve --flush-caches` (Linux)
3. Check from different locations using online tools
4. Verify you entered the records correctly in Hostinger

### Mail-in-a-Box Shows DNS Errors

1. Double-check all records are entered exactly as provided
2. Ensure TTL values are reasonable (not too high)
3. Wait for full DNS propagation
4. Check for typos in domain names or IP addresses

### Emails Going to Spam

1. Verify SPF, DKIM, and DMARC records are correctly configured
2. Use [Mail-Tester](https://www.mail-tester.com/) to check your spam score
3. Ensure you're not sending too many emails initially (warm up your IP)
4. Check that your domain reputation is good

