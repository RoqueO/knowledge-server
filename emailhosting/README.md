# Email Server Self-Hosting Documentation

This documentation provides a complete guide for setting up a self-hosted email server on your Proxmox server for the domain `obusan.me`, allowing email addresses like `roque@obusan.me`, `matteo@obusan.me`, and others.

## Overview

This setup uses **Mail-in-a-Box**, an all-in-one email server solution that automatically configures Postfix, Dovecot, SpamAssassin, ClamAV, and more. It provides a simple web interface for management and includes webmail access.

**Key Features:**
- Simple setup with automatic configuration
- Web-based administration panel
- Built-in security (SPF, DKIM, DMARC)
- Webmail included (Roundcube)
- Gmail client integration via IMAP/SMTP
- No ISP involvement required

## Architecture

- **Container Type**: LXC (lightweight, low resource usage)
- **OS**: Ubuntu 22.04 LTS
- **Mail Server**: Mail-in-a-Box
- **Domain**: obusan.me
- **Mail Hostname**: mail.obusan.me
- **Network**: LAN (192.168.1.0/24)

## Quick Reference

### Mail Server Details
- **IMAP Server**: mail.obusan.me (port 993, SSL/TLS)
- **SMTP Server**: mail.obusan.me (port 587, STARTTLS)
- **Webmail**: https://mail.obusan.me
- **Admin Panel**: https://mail.obusan.me/admin

### Required Ports (pfSense Forwarding)
- **Port 25**: SMTP (may be blocked by ISP)
- **Port 587**: SMTP submission (primary for sending)
- **Port 993**: IMAPS (for email clients)
- **Port 995**: POP3S (optional)
- **Port 80/443**: HTTP/HTTPS (webmail and Let's Encrypt)

### DNS Records (Hostinger)
- **MX**: mail.obusan.me → your public IP
- **A**: mail.obusan.me → your public IP
- **SPF**: TXT record (provided by Mail-in-a-Box)
- **DKIM**: TXT record (generated by Mail-in-a-Box)
- **DMARC**: TXT record (template from Mail-in-a-Box)

## Documentation Structure

1. **[dns-configuration.md](dns-configuration.md)** - DNS records setup at Hostinger
2. **[proxmox-lxc-setup.md](proxmox-lxc-setup.md)** - LXC container creation and configuration
3. **[mail-in-a-box-installation.md](mail-in-a-box-installation.md)** - Mail-in-a-Box installation and initial setup
4. **[firewall-configuration.md](firewall-configuration.md)** - pfSense port forwarding and firewall rules
5. **[user-management.md](user-management.md)** - Creating and managing email accounts
6. **[gmail-integration.md](gmail-integration.md)** - Setting up Gmail as email client
7. **[testing-troubleshooting.md](testing-troubleshooting.md)** - Testing procedures and common issues
8. **[maintenance.md](maintenance.md)** - Backup, monitoring, and maintenance procedures

## Implementation Order

1. **DNS Configuration** - Set up initial DNS records at Hostinger (A and MX records)
2. **Proxmox LXC Setup** - Create Ubuntu 22.04 LTS container
3. **Mail-in-a-Box Installation** - Install and configure Mail-in-a-Box
4. **Firewall Configuration** - Configure pfSense port forwarding
5. **Complete DNS Setup** - Add SPF, DKIM, DMARC records (values from Mail-in-a-Box)
6. **User Management** - Create email accounts (roque@obusan.me, matteo@obusan.me, etc.)
7. **Gmail Integration** - Configure Gmail to access your email
8. **Testing** - Verify email sending/receiving and deliverability
9. **Maintenance Setup** - Configure backups and monitoring

## Important Notes

- **No ISP Involvement**: This setup works without reverse DNS or ISP port unblocking
- **Port 25**: May be blocked by ISP, but port 587 works for sending email
- **SPF/DKIM/DMARC**: More important than reverse DNS for deliverability
- **IP Reputation**: New IPs may need warm-up period - start with low email volume
- **Static IP**: Required for reliable email delivery

## Prerequisites

- Static public IP address
- Domain name (obusan.me) with DNS access at Hostinger
- Proxmox server with LXC support
- pfSense router with port forwarding capability
- Basic familiarity with command line and web interfaces

